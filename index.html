<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡πÅ‡∏ú‡πà‡∏ô‡∏à‡∏∏‡πà‡∏°‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à</title>
<link href="https://fonts.googleapis.com/css2?family=Itim&display=swap" rel="stylesheet">
<style>
@font-face {
  font-family: 'PG Rohan DEMO';
  src: url('PG_Rohan_DEMO.ttf') format('truetype');
}
body { 
  font-family: 'PG Rohan DEMO', cursive; 
  text-align: center; 
  background: #ffffff; 
  margin: 0; 
  padding: 20px;
}
h1 { 
  color: #ff6f91; 
  font-size: 2.5em; 
  margin-bottom: 10px;
}
p { color:#ff6f91; font-size:1.2em; }

/* ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ */
#basket { 
  width:200px; 
  margin-top:30px; 
  cursor:pointer; 
  transition: transform 0.2s;
}
.shake { 
  animation: shake 0.5s; 
}
@keyframes shake {
  0% { transform: translate(0, 0) rotate(0deg); }
  25% { transform: translate(-5px, 0) rotate(-5deg); }
  50% { transform: translate(5px, 0) rotate(5deg); }
  75% { transform: translate(-5px, 0) rotate(-5deg); }
  100% { transform: translate(0, 0) rotate(0deg); }
}

/* ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© */
.paper { 
  width:140px; height:90px; 
  background:#fff0f5; 
  border:2px dashed #ff6f91; 
  border-radius:12px; 
  margin:20px auto; 
  cursor:pointer;
  display:flex; justify-content:center; align-items:center;
  font-size:16px; color:#ff6f91;
  box-shadow: 2px 2px 8px rgba(0,0,0,0.3);
  transition: transform 0.2s, box-shadow 0.2s;
}
.paper:hover { transform: scale(1.1); background:#ffe4ec; box-shadow: 4px 4px 12px rgba(0,0,0,0.4); }

/* Scratch container */
#scratch-container { 
  position:relative; 
  display:none; 
  width:400px; 
  margin:20px auto; 
  border-radius:12px;
  box-shadow: 0 6px 12px rgba(0,0,0,0.2);
}
#main-img { 
  width:100%; 
  border-radius:12px; 
  display:block;
}
#scratchCanvas { 
  position:absolute; top:0; left:0; 
  border-radius:12px; 
}

/* ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î */
#downloadBtn { 
  display:none; 
  margin-top:20px; 
  padding:10px 20px; 
  background:#ff6f91; 
  color:white; 
  border:none; 
  border-radius:12px; 
  cursor:pointer; 
  font-size:16px;
  transition: transform 0.2s, background 0.2s;
}
#downloadBtn:hover { 
  background:#ff4d7a; 
  transform: scale(1.05);
}
</style>
</head>
<body>
<h1>üéÄ ‡πÅ‡∏ú‡πà‡∏ô‡∏à‡∏∏‡πà‡∏°‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à üéÄ</h1>
<p>‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏π‡∏î‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å üíå</p>

<img id="basket" src="basket.png" alt="basket">

<div id="papers"></div>

<div id="scratch-container">
  <img id="main-img" src="photo1.jpg" alt="main">
  <canvas id="scratchCanvas" width="400" height="300"></canvas>
</div>

<button id="downloadBtn">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</button>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
const basket = document.getElementById("basket");
const papers = document.getElementById("papers");
const container = document.getElementById("scratch-container");
const canvas = document.getElementById("scratchCanvas");
const ctx = canvas.getContext("2d");
const downloadBtn = document.getElementById("downloadBtn");

// ‡∏´‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©
const papersImages = ["photo1.jpg","photo2.jpg","photo3.jpg"];
let currentImage = "";

function showPaper(){
  if(papers.children.length>0) return;
  basket.classList.add("shake");
  setTimeout(()=>basket.classList.remove("shake"),600);

  const paper=document.createElement("div");
  paper.className="paper";
  paper.innerText="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏π‡∏î";
  // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏û‡∏™‡∏∏‡πà‡∏°
  currentImage = papersImages[Math.floor(Math.random()*papersImages.length)];
  paper.onclick=startScratch;
  papers.appendChild(paper);
}

// mouse shake
document.addEventListener("mousemove",e=>{
  if(Math.abs(e.movementX)+Math.abs(e.movementY)>30){
    showPaper();
  }
});
// phone shake
window.addEventListener("devicemotion", e=>{
  const acc=e.accelerationIncludingGravity;
  if(acc && (Math.abs(acc.x)+Math.abs(acc.y)+Math.abs(acc.z) > 30)){
    showPaper();
  }
});

// scratch
function startScratch(){
  papers.innerHTML="";
  container.style.display="block";
  document.getElementById("main-img").src=currentImage;

  ctx.fillStyle="#c0c0c0";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  let drawing=false;
  canvas.addEventListener("mousedown",()=>drawing=true);
  canvas.addEventListener("mouseup",()=>drawing=false);
  canvas.addEventListener("mousemove",scratch);
  canvas.addEventListener("touchstart",()=>drawing=true);
  canvas.addEventListener("touchend",()=>drawing=false);
  canvas.addEventListener("touchmove",scratch);

  function scratch(e){
    if(!drawing) return;
    const rect=canvas.getBoundingClientRect();
    const x=(e.touches?e.touches[0].clientX:e.clientX)-rect.left;
    const y=(e.touches?e.touches[0].clientY:e.clientY)-rect.top;
    ctx.globalCompositeOperation="destination-out";
    ctx.beginPath();
    ctx.arc(x,y,20,0,Math.PI*2);
    ctx.fill();
    checkReveal();
  }

  function checkReveal(){
    const imgData=ctx.getImageData(0,0,canvas.width,canvas.height);
    let total=imgData.data.length/4, cleared=0;
    for(let i=0;i<imgData.data.length;i+=4){
      if(imgData.data[i+3]===0) cleared++;
    }
    if(cleared/total > 0.6){
      canvas.style.display="none";
      downloadBtn.style.display="inline-block";
      // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Ñ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡∏ï‡∏ï‡∏µ‡πâ
      confetti({particleCount:100, spread:70, origin:{y:0.6}});
    }
  }
}

// ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
downloadBtn.onclick=function(){
  const link=document.createElement("a");
  link.download=currentImage;
  link.href=document.getElementById("main-img").src;
  link.click();
};
</script>
</body>
</html>
